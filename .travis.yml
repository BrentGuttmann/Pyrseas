language: python
python:
  - "3.6"
  - "2.7"
addons:
  postgresql: "10"
  apt:
    packages:
    - postgresql-10
    - postgresql-client-10
    - postgresql-plperl-10
    - postgresql-plpython-10
env:
  global:
  - PGPORT=5433
before_install:
  - export PATH=/usr/lib/postgresql/10/bin:$PATH
  - sudo locale-gen --no-archive fr_FR.UTF-8
  - sudo mkdir -p /extra/pg/ts1 /extra/pg/ts2
  - sudo chown postgres:postgres /extra/pg/ts1 /extra/pg/ts2
before_script:
  - psql -Upostgres -c "CREATE TABLESPACE ts1 LOCATION '/extra/pg/ts1'"
  - psql -Upostgres -c "CREATE TABLESPACE ts2 LOCATION '/extra/pg/ts2'"
script:
  - python setup.py test
